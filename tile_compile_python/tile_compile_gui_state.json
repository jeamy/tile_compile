{
  "lastInputDir": "/media/data/tile_compile_cache/IC434_lights",
  "scanInputDir": "/media/data/tile_compile_cache/IC434_lights",
  "inputDir": "/media/data/tile_compile_cache/IC434_lights",
  "workingDir": "/home/lux/programming/tile-compile/tile_compile_python",
  "runsDir": "runs",
  "pattern": "*.fit*",
  "dryRun": false,
  "scanFramesMin": 1,
  "scanWithChecksums": false,
  "confirmedColorMode": "OSC",
  "calibration": {
    "use_bias": false,
    "use_dark": false,
    "use_flat": false,
    "bias_use_master": false,
    "dark_use_master": false,
    "flat_use_master": false,
    "bias_dir": "",
    "darks_dir": "/media/data/Astro/DwarfII/Astronomy/DWARF_DARK/tele_exp_1_gain_60_bin_1_2026-01-10-13-31-44-669",
    "flats_dir": "",
    "bias_master": "",
    "dark_master": "",
    "flat_master": "",
    "pattern": "*.fit*"
  },
  "configPath": "/home/lux/programming/tile-compile/tile_compile_python/tile_compile.yaml",
  "configYaml": "# FILE: tile_compile.yaml\n# PURPOSE\n# - User-editable configuration for a Tile-Compile run.\n# - This file is validated against tile_compile.schema.json.\n# - Values aligned with Methodik v4 (doc/tile_basierte_qualitaetsrekonstruktion_methodik_v_4.md).\n#\n# NOTES\n# - Methodik v4: Tile-wise Local Registration (TLR), no global registration.\n# - \"assumptions\" contains v4 tolerance thresholds and Reduced Mode behavior.\n# - The runner may derive additional input metadata at runtime (image size, frame count, etc.).\n\npipeline:\n  mode: production\n  abort_on_fail: true\n\ndata:\n  image_width: 3840\n  image_height: 2160\n  frames_min: 50\n  color_mode: OSC\n  bayer_pattern: GBRG\n  linear_required: true\n\ncalibration:\n  use_bias: false\n  use_dark: true\n  use_flat: false\n  bias_use_master: false\n  dark_use_master: true\n  flat_use_master: false\n  bias_dir: \"\"\n  darks_dir: \"\"\n  flats_dir: \"\"\n  bias_master: \"\"\n  dark_master: \"\"\n  flat_master: \"\"\n  pattern: \"*.fit*\"\n\nassumptions:\n  frames_min: 50\n  frames_optimal: 200\n  frames_reduced_threshold: 199\n  exposure_time_tolerance_percent: 5.0\n  warp_variance_warn: 2.0              # v4: warp variance warning threshold\n  warp_variance_max: 8.0               # v4: max warp variance (tile invalid above)\n  elongation_warn: 0.3\n  elongation_max: 0.4\n  tracking_error_max_px: 1.0\n  reduced_mode_skip_clustering: true\n  reduced_mode_cluster_range: [5, 10]\n\n# Methodik v4 specific parameters\nv4:\n  iterations: 3                        # iterative reconstruction iterations (§5.2)\n  beta: 5.0                            # R_{f,t} = exp(β·(cc-1)) sensitivity (§7)\n  min_valid_tile_fraction: 0.3         # abort if < 30% valid tiles (§12)\n\nnormalization:\n  enabled: true\n  mode: background        # background | median\n  per_channel: true\n\nregistration:\n  # Methodik v4: Tile-wise Local Registration (TLR)\n  # No global registration - each tile registers independently\n  local_tiles:\n    model: translation                    # translation only (rotation absorbed locally)\n    ecc_cc_min: 0.2                      # minimum ECC correlation to accept\n    min_valid_frames: 10                 # minimum frames required per tile\n    reference_method: median_time        # median_time | min_gradient\n    max_tile_size: 128                   # hard limit for strong field rotation\n    registration_quality_beta: 5.0       # R_{f,t} weight sensitivity (§7)\n    max_iterations: 3                    # iterative reference refinement (§5.2)\n    temporal_smoothing_window: 11        # Savitzky-Golay window (must be odd)\n    temporal_smoothing_polyorder: 3      # polynomial order for smoothing\n    # Experimental features (Methodik v4)\n    enable_recursive_refinement: true    # §4: split tiles with high warp variance\n    refinement_variance_threshold: 4.0   # max variance before refinement\n    refinement_max_depth: 2              # maximum recursion depth\n    variance_window_sigma: 2.0           # ψ(var) scale parameter (§9)\n\nwiener_denoise:\n  enabled: true\n  snr_threshold: 5.0\n  q_min: -0.5\n\nglobal_metrics:\n  weights:\n    background: 0.4\n    noise: 0.3\n    gradient: 0.3\n  clamp: [-3, 3]\n\ntile:\n  size_factor: 32\n  min_size: 64\n  max_divisor: 6\n  overlap_fraction: 0.25\n  star_min_count: 3\n\nlocal_metrics:\n  clamp: [-3, 3]\n  star_mode:\n    # FWHM, roundness und contrast werden gemäß Methodik v3.1 MAD-normalisiert;\n    # es gibt kein log-Transform mehr. Die Gewichte definieren direkt die\n    # Kombination Q_star = w_fwhm·(-FWHM̃) + w_round·R̃ + w_con·C̃.\n    weights:\n      fwhm: 0.6\n      roundness: 0.2\n      contrast: 0.2\n  structure_mode:\n    # Strukturmodus nutzt ENR = E/σ und lokalen Hintergrund B_local:\n    #   Q_struct = metric_weight·ENR̃ − background_weight·B̃_local\n    background_weight: 0.3\n    metric_weight: 0.7\n\nsynthetic:\n  weighting: tile_weighted\n  frames_min: 15\n  frames_max: 30\n  clustering:\n    mode: state_vector\n    vector:\n      - global_weight\n      - tile_quality_mean\n      - tile_quality_variance\n      - background\n      - noise\n\nreconstruction:\n  weighting_function: exponential\n  window_function: hanning\n  tile_rescale: median_after_background_subtraction\n\ndebayer: true\n\nstacking:\n  method: rej\n  # Default: stack synthetic RGB frames (syn_*.fits) produced in SYNTHETIC_FRAMES.\n  # In reduced mode or when no synthetic frames exist, the pipeline falls back\n  # to reconstructed_* channels automatically.\n  input_dir: synthetic\n  input_pattern: \"syn_*.fits\"\n  output_file: stacked.fit\n  sigma_clip:\n    sigma_low: 2\n    sigma_high: 2\n    max_iters: 3\n    min_fraction: 0.5\n\nvalidation:\n  min_fwhm_improvement_percent: 5\n  max_background_rms_increase_percent: 0\n  min_tile_weight_variance: 0.1\n  require_no_tile_pattern: true\n\nruntime_limits:\n  tile_analysis_max_factor_vs_stack: 3.0\n  hard_abort_hours: 6\n",
  "configValidatedOk": true,
  "assumptions": {
    "frames_min": 50,
    "frames_optimal": 200,
    "frames_reduced_threshold": 199,
    "exposure_time_tolerance_percent": 5.0,
    "registration_residual_warn_px": 0.5,
    "registration_residual_max_px": 1.0,
    "elongation_warn": 0.3,
    "elongation_max": 0.4,
    "tracking_error_max_px": 1.0,
    "reduced_mode_skip_clustering": true,
    "reduced_mode_cluster_range": [
      5,
      10
    ]
  },
  "logsTail": 200,
  "logsFilter": "",
  "activeTab": 4
}
